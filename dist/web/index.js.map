{
  "version": 3,
  "sources": ["../esm/index.js"],
  "sourcesContent": ["var _root = null;\nvar signalProto = {\n    set: function (newValue) {\n        this._value = newValue;\n        this._subscribers.forEach(function (callback) { return callback(); });\n    },\n    subscribe: function (callback) {\n        var _this = this;\n        this._subscribers.push(callback);\n        return function () {\n            _this._subscribers.splice(_this._subscribers.indexOf(callback), 1);\n        };\n    },\n    destroy: function () { },\n    valueOf: function () {\n        return this();\n    },\n    toString: function () {\n        return \"\".concat(this());\n    }\n};\nexport function use(initialValue) {\n    var signal = function () {\n        if (_root !== null)\n            _root.push(this);\n        return this._value;\n    };\n    Object.assign(signal, signalProto, {\n        _value: initialValue,\n        _subscribers: []\n    });\n    return signal;\n}\nfunction withRoot(fn) {\n    var oldRoot = _root;\n    _root = [];\n    var ret = fn();\n    var newRoot = _root;\n    _root = oldRoot;\n    return { signals: newRoot, ret: ret };\n}\nexport function effect(callback) {\n    var signals = withRoot(callback).signals;\n    var unsubscribers = signals.map(function (signal) { return signal.subscribe(callback); });\n    return function () { return unsubscribers.forEach(function (unsubscribe) { return unsubscribe(); }); };\n}\nexport function derived(deriveFn) {\n    var _a = withRoot(deriveFn), signals = _a.signals, ret = _a.ret;\n    var signal = use(ret);\n    var callback = function () { return signal.set(deriveFn()); };\n    var unsubscribers = signals.map(function (signal) { return signal.subscribe(callback); });\n    signal.destroy = function () { return unsubscribers.forEach(function (unsubscribe) { return unsubscribe(); }); };\n    return signal;\n}\n"],
  "mappings": "+eAAA,IAAIA,EAAQ,KACRC,EAAc,CACd,IAAK,SAAUC,EAAU,CACrB,KAAK,OAASA,EACd,KAAK,aAAa,QAAQ,SAAUC,EAAU,CAAE,OAAOA,EAAS,CAAG,CAAC,CACxE,EACA,UAAW,SAAUA,EAAU,CAC3B,IAAIC,EAAQ,KACZ,OAAA,KAAK,aAAa,KAAKD,CAAQ,EACxB,UAAY,CACfC,EAAM,aAAa,OAAOA,EAAM,aAAa,QAAQD,CAAQ,EAAG,CAAC,CACrE,CACJ,EACA,QAAS,UAAY,CAAE,EACvB,QAAS,UAAY,CACjB,OAAO,KAAK,CAChB,EACA,SAAU,UAAY,CAClB,MAAO,GAAG,OAAO,KAAK,CAAC,CAC3B,CACJ,EACO,SAASE,EAAIC,EAAc,CAC9B,IAAIC,EAAS,UAAY,CACrB,OAAIP,IAAU,MACVA,EAAM,KAAK,IAAI,EACZ,KAAK,MAChB,EACA,OAAA,OAAO,OAAOO,EAAQN,EAAa,CAC/B,OAAQK,EACR,aAAc,CAAC,CACnB,CAAC,EACMC,CACX,CACA,SAASC,EAASC,EAAI,CAClB,IAAIC,EAAUV,EACdA,EAAQ,CAAC,EACT,IAAIW,EAAMF,EAAG,EACTG,EAAUZ,EACd,OAAAA,EAAQU,EACD,CAAE,QAASE,EAAS,IAAKD,CAAI,CACxC,CACO,SAASE,EAAOV,EAAU,CAC7B,IAAIW,EAAUN,EAASL,CAAQ,EAAE,QAC7BY,EAAgBD,EAAQ,IAAI,SAAUP,EAAQ,CAAE,OAAOA,EAAO,UAAUJ,CAAQ,CAAG,CAAC,EACxF,OAAO,UAAY,CAAE,OAAOY,EAAc,QAAQ,SAAUC,EAAa,CAAE,OAAOA,EAAY,CAAG,CAAC,CAAG,CACzG,CACO,SAASC,EAAQC,EAAU,CAC9B,IAAIC,EAAKX,EAASU,CAAQ,EAAGJ,EAAUK,EAAG,QAASR,EAAMQ,EAAG,IACxDZ,EAASF,EAAIM,CAAG,EAChBR,EAAW,UAAY,CAAE,OAAOI,EAAO,IAAIW,EAAS,CAAC,CAAG,EACxDH,EAAgBD,EAAQ,IAAI,SAAUP,EAAQ,CAAE,OAAOA,EAAO,UAAUJ,CAAQ,CAAG,CAAC,EACxF,OAAAI,EAAO,QAAU,UAAY,CAAE,OAAOQ,EAAc,QAAQ,SAAUC,EAAa,CAAE,OAAOA,EAAY,CAAG,CAAC,CAAG,EACxGT,CACX",
  "names": ["_root", "signalProto", "newValue", "callback", "_this", "use", "initialValue", "signal", "withRoot", "fn", "oldRoot", "ret", "newRoot", "effect", "signals", "unsubscribers", "unsubscribe", "derived", "deriveFn", "_a"]
}
