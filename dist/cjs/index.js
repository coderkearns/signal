"use strict";var __extends=this&&this.__extends||function(){var e=function(n,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])},e(n,r)};return function(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(n,r);function t(){this.constructor=n}n.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.derived=exports.effect=exports.use=void 0;var _root=null,Signal=function(e){__extends(n,e);function n(r){var t=e.call(this,"...args","return this._call(...args)")||this,o=t.bind(t);return t._value=r,t._subscribers=[],o}return n.prototype._call=function(){return _root!==null&&_root.push(this),this._value},n.prototype.set=function(r){this._value=r,this._subscribers.forEach(function(t){return t()})},n.prototype.subscribe=function(r){var t=this;return this._subscribers.push(r),function(){t._subscribers.splice(t._subscribers.indexOf(r),1)}},n.prototype.destroy=function(){},n.prototype.valueOf=function(){return this()},n.prototype.toString=function(){return"".concat(this())},n}(Function),signalProto={};function use(e){return new Signal(e)}exports.use=use;function withRoot(e){var n=_root;_root=[];var r=e(),t=_root;return _root=n,{signals:t,ret:r}}function effect(e){var n=withRoot(e).signals,r=n.map(function(t){return t.subscribe(e)});return function(){return r.forEach(function(t){return t()})}}exports.effect=effect;function derived(e){var n=withRoot(e),r=n.signals,t=n.ret,o=use(t),s=function(){return o.set(e())},u=r.map(function(i){return i.subscribe(s)});return o.destroy=function(){return u.forEach(function(i){return i()})},o}exports.derived=derived;
//# sourceMappingURL=index.js.map
