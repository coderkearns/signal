{
  "version": 3,
  "sources": ["index.js"],
  "sourcesContent": ["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.derived = exports.effect = exports.use = void 0;\nvar _root = null;\nvar Signal = /** @class */ (function (_super) {\n    __extends(Signal, _super);\n    function Signal(initialValue) {\n        var _this = _super.call(this, \"...args\", \"return this._call(...args)\") || this;\n        var self = _this.bind(_this);\n        _this._value = initialValue;\n        _this._subscribers = [];\n        return self;\n    }\n    Signal.prototype._call = function () {\n        if (_root !== null)\n            _root.push(this);\n        return this._value;\n    };\n    Signal.prototype.set = function (newValue) {\n        this._value = newValue;\n        this._subscribers.forEach(function (callback) { return callback(); });\n    };\n    Signal.prototype.subscribe = function (callback) {\n        var _this = this;\n        this._subscribers.push(callback);\n        return function () {\n            _this._subscribers.splice(_this._subscribers.indexOf(callback), 1);\n        };\n    };\n    Signal.prototype.destroy = function () { };\n    Signal.prototype.valueOf = function () {\n        return this();\n    };\n    Signal.prototype.toString = function () {\n        return \"\".concat(this());\n    };\n    return Signal;\n}(Function));\nvar signalProto = {};\nfunction use(initialValue) {\n    return new Signal(initialValue);\n}\nexports.use = use;\nfunction withRoot(fn) {\n    var oldRoot = _root;\n    _root = [];\n    var ret = fn();\n    var newRoot = _root;\n    _root = oldRoot;\n    return { signals: newRoot, ret: ret };\n}\nfunction effect(callback) {\n    var signals = withRoot(callback).signals;\n    var unsubscribers = signals.map(function (signal) { return signal.subscribe(callback); });\n    return function () { return unsubscribers.forEach(function (unsubscribe) { return unsubscribe(); }); };\n}\nexports.effect = effect;\nfunction derived(deriveFn) {\n    var _a = withRoot(deriveFn), signals = _a.signals, ret = _a.ret;\n    var signal = use(ret);\n    var callback = function () { return signal.set(deriveFn()); };\n    var unsubscribers = signals.map(function (signal) { return signal.subscribe(callback); });\n    signal.destroy = function () { return unsubscribers.forEach(function (unsubscribe) { return unsubscribe(); }); };\n    return signal;\n}\nexports.derived = derived;\n"],
  "mappings": "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",
  "names": ["extendStatics", "d", "b", "p", "__", "_super", "Signal", "initialValue", "_this", "self", "newValue", "callback", "fn", "oldRoot", "ret", "newRoot", "signals", "unsubscribers", "signal", "unsubscribe", "deriveFn", "_a"]
}
