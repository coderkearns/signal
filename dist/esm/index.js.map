{
  "version": 3,
  "sources": ["index.js"],
  "sourcesContent": ["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar _root = null;\nvar Signal = /** @class */ (function (_super) {\n    __extends(Signal, _super);\n    function Signal(initialValue) {\n        var _this = _super.call(this, \"...args\", \"return this._call(...args)\") || this;\n        var self = _this.bind(_this);\n        _this._value = initialValue;\n        _this._subscribers = [];\n        return self;\n    }\n    Signal.prototype._call = function () {\n        if (_root !== null)\n            _root.push(this);\n        return this._value;\n    };\n    Signal.prototype.set = function (newValue) {\n        this._value = newValue;\n        this._subscribers.forEach(function (callback) { return callback(); });\n    };\n    Signal.prototype.subscribe = function (callback) {\n        var _this = this;\n        this._subscribers.push(callback);\n        return function () {\n            _this._subscribers.splice(_this._subscribers.indexOf(callback), 1);\n        };\n    };\n    Signal.prototype.destroy = function () { };\n    Signal.prototype.valueOf = function () {\n        return this();\n    };\n    Signal.prototype.toString = function () {\n        return \"\".concat(this());\n    };\n    return Signal;\n}(Function));\nvar signalProto = {};\nexport function use(initialValue) {\n    return new Signal(initialValue);\n}\nfunction withRoot(fn) {\n    var oldRoot = _root;\n    _root = [];\n    var ret = fn();\n    var newRoot = _root;\n    _root = oldRoot;\n    return { signals: newRoot, ret: ret };\n}\nexport function effect(callback) {\n    var signals = withRoot(callback).signals;\n    var unsubscribers = signals.map(function (signal) { return signal.subscribe(callback); });\n    return function () { return unsubscribers.forEach(function (unsubscribe) { return unsubscribe(); }); };\n}\nexport function derived(deriveFn) {\n    var _a = withRoot(deriveFn), signals = _a.signals, ret = _a.ret;\n    var signal = use(ret);\n    var callback = function () { return signal.set(deriveFn()); };\n    var unsubscribers = signals.map(function (signal) { return signal.subscribe(callback); });\n    signal.destroy = function () { return unsubscribers.forEach(function (unsubscribe) { return unsubscribe(); }); };\n    return signal;\n}\n"],
  "mappings": "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",
  "names": ["__extends", "extendStatics", "d", "b", "p", "__", "_root", "Signal", "_super", "initialValue", "_this", "self", "newValue", "callback", "signalProto", "withRoot", "fn", "oldRoot", "ret", "newRoot", "signals", "unsubscribers", "signal", "unsubscribe", "deriveFn", "_a"]
}
