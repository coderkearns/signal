{
  "version": 3,
  "sources": ["index.js"],
  "sourcesContent": ["var _root = null;\nvar signalProto = {\n    set: function (newValue) {\n        this._value = newValue;\n        this._subscribers.forEach(function (callback) { return callback(); });\n    },\n    subscribe: function (callback) {\n        var _this = this;\n        this._subscribers.push(callback);\n        return function () {\n            _this._subscribers.splice(_this._subscribers.indexOf(callback), 1);\n        };\n    },\n    destroy: function () { },\n    valueOf: function () {\n        return this();\n    },\n    toString: function () {\n        return \"\".concat(this());\n    }\n};\nexport function use(initialValue) {\n    var signal = function () {\n        if (_root !== null)\n            _root.push(this);\n        return this._value;\n    };\n    Object.assign(signal, signalProto, {\n        _value: initialValue,\n        _subscribers: []\n    });\n    return signal;\n}\nfunction withRoot(fn) {\n    var oldRoot = _root;\n    _root = [];\n    var ret = fn();\n    var newRoot = _root;\n    _root = oldRoot;\n    return { signals: newRoot, ret: ret };\n}\nexport function effect(callback) {\n    var signals = withRoot(callback).signals;\n    var unsubscribers = signals.map(function (signal) { return signal.subscribe(callback); });\n    return function () { return unsubscribers.forEach(function (unsubscribe) { return unsubscribe(); }); };\n}\nexport function derived(deriveFn) {\n    var _a = withRoot(deriveFn), signals = _a.signals, ret = _a.ret;\n    var signal = use(ret);\n    var callback = function () { return signal.set(deriveFn()); };\n    var unsubscribers = signals.map(function (signal) { return signal.subscribe(callback); });\n    signal.destroy = function () { return unsubscribers.forEach(function (unsubscribe) { return unsubscribe(); }); };\n    return signal;\n}\n"],
  "mappings": "aAAA,IAAIA,EAAQ,KACRC,EAAc,CACd,IAAK,SAAUC,EAAU,CACrB,KAAK,OAASA,EACd,KAAK,aAAa,QAAQ,SAAUC,EAAU,CAAE,OAAOA,EAAS,CAAG,CAAC,CACxE,EACA,UAAW,SAAUA,EAAU,CAC3B,IAAIC,EAAQ,KACZ,YAAK,aAAa,KAAKD,CAAQ,EACxB,UAAY,CACfC,EAAM,aAAa,OAAOA,EAAM,aAAa,QAAQD,CAAQ,EAAG,CAAC,CACrE,CACJ,EACA,QAAS,UAAY,CAAE,EACvB,QAAS,UAAY,CACjB,OAAO,KAAK,CAChB,EACA,SAAU,UAAY,CAClB,MAAO,GAAG,OAAO,KAAK,CAAC,CAC3B,CACJ,EACO,gBAAS,IAAIE,EAAc,CAC9B,IAAIC,EAAS,UAAY,CACrB,OAAIN,IAAU,MACVA,EAAM,KAAK,IAAI,EACZ,KAAK,MAChB,EACA,cAAO,OAAOM,EAAQL,EAAa,CAC/B,OAAQI,EACR,aAAc,CAAC,CACnB,CAAC,EACMC,CACX,CACA,SAASC,EAASC,EAAI,CAClB,IAAIC,EAAUT,EACdA,EAAQ,CAAC,EACT,IAAIU,EAAMF,EAAG,EACTG,EAAUX,EACd,OAAAA,EAAQS,EACD,CAAE,QAASE,EAAS,IAAKD,CAAI,CACxC,CACO,gBAAS,OAAOP,EAAU,CAC7B,IAAIS,EAAUL,EAASJ,CAAQ,EAAE,QAC7BU,EAAgBD,EAAQ,IAAI,SAAUN,EAAQ,CAAE,OAAOA,EAAO,UAAUH,CAAQ,CAAG,CAAC,EACxF,OAAO,UAAY,CAAE,OAAOU,EAAc,QAAQ,SAAUC,EAAa,CAAE,OAAOA,EAAY,CAAG,CAAC,CAAG,CACzG,CACO,gBAAS,QAAQC,EAAU,CAC9B,IAAIC,EAAKT,EAASQ,CAAQ,EAAGH,EAAUI,EAAG,QAASN,EAAMM,EAAG,IACxDV,EAAS,IAAII,CAAG,EAChBP,EAAW,UAAY,CAAE,OAAOG,EAAO,IAAIS,EAAS,CAAC,CAAG,EACxDF,EAAgBD,EAAQ,IAAI,SAAUN,EAAQ,CAAE,OAAOA,EAAO,UAAUH,CAAQ,CAAG,CAAC,EACxF,OAAAG,EAAO,QAAU,UAAY,CAAE,OAAOO,EAAc,QAAQ,SAAUC,EAAa,CAAE,OAAOA,EAAY,CAAG,CAAC,CAAG,EACxGR,CACX",
  "names": ["_root", "signalProto", "newValue", "callback", "_this", "initialValue", "signal", "withRoot", "fn", "oldRoot", "ret", "newRoot", "signals", "unsubscribers", "unsubscribe", "deriveFn", "_a"]
}
